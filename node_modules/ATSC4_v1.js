
function ATSC4(){}

ATSC4.key = function(k){
    let pre = ">1KK=";
    let str = "";
    switch(k.toLowerCase()){
        case("power"):{str = "9";break}
        case("menu"):{str = "105";break}
        case("info"):{str = "100";break}
        case("guide"):{str = "63";break}
        case("exit"):{str = "111";break}

        case("up"):{str = "108";break}
        case("down"):{str = "109";break}
        case("left"):{str = "107";break}
        case("right"):{str = "106";break}
        case("select"):{str = "110";break}
        
        case("digit_1"):{str = "11";break}
        case("digit_2"):{str = "12";break}
        case("digit_3"):{str = "13";break}
        case("digit_4"):{str = "14";break}
        case("digit_5"):{str = "15";break}
        case("digit_6"):{str = "16";break}
        case("digit_7"):{str = "17";break}
        case("digit_8"):{str = "18";break}
        case("digit_9"):{str = "19";break}
        case("dash"):   {str = "99";break}
        case("digit_0"):{str = "10";break}
        case("enter"):  {str = "110";break}

        case("channel+"):{str = "22";break}
        case("channel-"):{str = "23";break}
        
        case("power"):{str = "9";break}
        default:{str = "0";break}
    }
    //log.info(pre + str);
    return pre + str + "\r\n";
}
ATSC4.set = {
    channel:function(ch){
        return ">0TC=" + ch + '\r\n';       
    }
}
ATSC4.status = {
    power:{state:false},
    channel:{major:false,minor:false},
    vidMute:{state:false},
    input:{state:false},
    rf:{state:false},
    resolution:{state:false}
}
ATSC4.response = function(rx){
    //log.info("[RX]:" + rx);
    switch(rx[2]){
        case("T"):{
            ATSC4.status.power.state = (rx[3] == "U");
            ATSC4.status.vidMute.state = (rx[7] !== "U");
            ATSC4.status.input.state = (rx[8] == "0") ? "RF" : false;
            ATSC4.status.rf.state = (rx[8] == "A") ? "air" :"cable";
            
            switch(rx[10]){
                case("0"):{ATSC4.status.resolution.state = "1080i";break}
                case("1"):{ATSC4.status.resolution.state = "720p";break}
                case("2"):{ATSC4.status.resolution.state = "480p";break}
                case("3"):{ATSC4.status.resolution.state = "480i";break}
                case("N"):{ATSC4.status.resolution.state = "No Signal";break}
            }
            
            ATSC4.status.channel.major = rx.substr(4,3);
            ATSC4.status.channel.minor = rx.substr(11,3);


            if (ATSC4.status.listen !== undefined) {ATSC4.status.listen()}
        }
    }


}

module.exports = ATSC4;